_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[32],{"1dNT":function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/instructor/course/edit/[slug]",function(){return n("LIYh")}])},LIYh:function(e,t,n){"use strict";n.r(t);var a=n("nKUr"),r=n("cpVT"),c=n("vJKn"),o=n.n(c),s=n("rg98"),i=n("q1tI"),l=n("V8zG"),u=n("RLs/"),d=n("fKpH"),p=n.n(d),b=n("FGyW"),f=n("zuR4"),j=n("20a2"),h=n("VXEj"),O=n("Tckk"),v=n("kLXV"),m=n("VTBJ"),g={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"},x=n("6VBw"),w=function(e,t){return i.createElement(x.a,Object(m.a)(Object(m.a)({},e),{},{ref:t,icon:g}))};var y=i.forwardRef(w),k=n("CFYs"),C=n("wx14"),N=n("rePB"),P=n("ye1Q"),_=n("TSYQ"),E=n.n(_),S=n("ODXe"),I=n("Ff2n"),L=n("6cGi"),D=n("4IlW"),T=i.forwardRef((function(e,t){var n,a=e.prefixCls,r=void 0===a?"rc-switch":a,c=e.className,o=e.checked,s=e.defaultChecked,l=e.disabled,u=e.loadingIcon,d=e.checkedChildren,p=e.unCheckedChildren,b=e.onClick,f=e.onChange,j=e.onKeyDown,h=Object(I.a)(e,["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"]),O=Object(L.a)(!1,{value:o,defaultValue:s}),v=Object(S.a)(O,2),m=v[0],g=v[1];function x(e,t){var n=m;return l||(g(n=e),null===f||void 0===f||f(n,t)),n}var w=E()(r,c,(n={},Object(N.a)(n,"".concat(r,"-checked"),m),Object(N.a)(n,"".concat(r,"-disabled"),l),n));return i.createElement("button",Object.assign({},h,{type:"button",role:"switch","aria-checked":m,disabled:l,className:w,ref:t,onKeyDown:function(e){e.which===D.a.LEFT?x(!1,e):e.which===D.a.RIGHT&&x(!0,e),null===j||void 0===j||j(e)},onClick:function(e){var t=x(!m,e);null===b||void 0===b||b(t,e)}}),u,i.createElement("span",{className:"".concat(r,"-inner")},m?d:p))}));T.displayName="Switch";var U=T,V=n("H84U"),R=n("caoh"),z=n("3Nzz"),H=n("g0mS"),B=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},F=i.forwardRef((function(e,t){var n=e.prefixCls,a=e.size,r=e.disabled,c=e.loading,o=e.className,s=void 0===o?"":o,l=B(e,["prefixCls","size","disabled","loading","className"]),u=i.useContext(V.b),d=u.getPrefixCls,p=u.direction,b=i.useContext(z.b),f=i.useContext(R.b),j=(null!==r&&void 0!==r?r:f)||c,h=d("switch",n),O=i.createElement("div",{className:"".concat(h,"-handle")},c&&i.createElement(P.a,{className:"".concat(h,"-loading-icon")})),v=E()(Object(N.a)(Object(N.a)(Object(N.a)({},"".concat(h,"-small"),"small"===(a||b)),"".concat(h,"-loading"),c),"".concat(h,"-rtl"),"rtl"===p),s);return i.createElement(H.a,{insertExtraNode:!0},i.createElement(U,Object(C.a)({},l,{prefixCls:h,className:v,disabled:j,ref:t,loadingIcon:O})))}));F.__ANT_SWITCH=!0;var G=F,K=n("2/Rp"),J=n("7l9Y"),X=n.n(J);function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M=function(e){var t=e.current,n=e.setCurrent,r=e.handleUpdateLesson,c=e.uploading,o=e.uploadVideoButtonText,s=e.handleVideo,i=e.progress;return Object(a.jsxs)("div",{className:"container pt-3",children:[Object(a.jsxs)("form",{onSubmit:r,children:[Object(a.jsx)("input",{type:"text",className:"form-control square",onChange:function(e){return n(q(q({},t),{},{title:e.target.value}))},value:t.title,autoFocus:!0,required:!0}),Object(a.jsx)("textarea",{className:"form-control mt-3",cols:"7",rows:"7",onChange:function(e){return n(q(q({},t),{},{content:e.target.value}))},value:t.content}),Object(a.jsx)("div",{className:"d-flex justify-content-center",children:!c&&t.video&&t.video.Location&&Object(a.jsx)("div",{className:"pt-2 d-flex justify-content-center",children:Object(a.jsx)(X.a,{url:t.video.Location,width:"380px",height:"180px",controls:!0})})}),Object(a.jsxs)("label",{className:"btn btn-secondary btn-block mt-3 col-12",children:[o,Object(a.jsx)("input",{onChange:s,type:"file",accept:"video/*",hidden:!0})]}),i>0&&Object(a.jsx)(k.a,{className:"d-flex justify-content-center pt-2",percent:i,steps:9}),Object(a.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(a.jsx)("p",{className:"pt-3",children:"Preview"}),Object(a.jsx)(G,{className:"float-right mt-2",disabled:c,checked:t.free_preview,name:"free_preview",onChange:function(e){return n(q(q({},t),{},{free_preview:e}))}})]})]}),Object(a.jsx)(K.a,{onClick:r,className:"col mt-3 d-grid col-8 mx-auto",size:"large",type:"primary",loading:c,shape:"round",children:"Save"})]})};function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=function(){var e=Object(i.useState)({name:"",description:"",price:"9.99",uploading:!1,paid:!0,category:"",loading:!1,lessons:[]}),t=e[0],n=e[1],c=Object(i.useState)({}),d=c[0],m=c[1],g=Object(i.useState)(""),x=g[0],w=g[1],k=Object(i.useState)("Upload Image"),C=k[0],N=k[1],P=Object(i.useState)(!1),_=P[0],E=P[1],S=Object(i.useState)({}),I=S[0],L=S[1],D=Object(i.useState)("Upload Video"),T=D[0],U=D[1],V=Object(i.useState)(0),R=V[0],z=V[1],H=Object(i.useState)(!1),B=H[0],F=H[1],G=Object(j.useRouter)(),K=G.query.slug;Object(i.useEffect)((function(){J()}),[K]);var J=function(){var e=Object(s.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/api/course/".concat(K));case 2:t=e.sent,a=t.data,console.log(a),a&&n(a),a&&a.image&&m(a.image);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),X=function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n(A(A({},t),{},{loading:!0})),e.next=4,f.a.post("/api/course/remove-image",{image:d});case 4:e.sent,m({}),w(""),N("Upload Image"),n(A(A({},t),{},{loading:!1})),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0),n(A(A({},t),{},{loading:!1})),Object(b.b)("Delete Image failed. Try again");case 16:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=Object(s.a)(o.a.mark((function e(n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,f.a.put("/api/course/".concat(K),A(A({},t),{},{image:d}));case 4:a=e.sent,a.data,Object(b.b)("Great! Course Updated"),G.push("/instructor"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),Object(b.b)(e.t0.response.data);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(s.a)(o.a.mark((function e(a){var r,c,s,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.confirm("Are you sure you want to delete lesson?")){e.next=3;break}return e.abrupt("return");case 3:return r=t.lessons,c=r.splice(a,1),n(A(A({},t),{},{lessons:r})),e.next=8,f.a.put("/api/course/".concat(K,"/").concat(c[0]._id));case 8:s=e.sent,i=s.data,console.log("Lesson Deleted",i);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=Object(s.a)(o.a.mark((function e(n){var a,r,c,s,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!I.video||!I.video.Location){e.next=5;break}return e.next=3,f.a.post("/api/course/video-remove/".concat(t.instructor._id),I.video);case 3:a=e.sent,console.log("Remove",a);case 5:return r=n.target.files[0],U(r.name),F(!0),(c=new FormData).append("video",r),c.append("courseId",t._id),e.next=13,f.a.post("/api/course/video-upload/".concat(t.instructor._id),c,{onUploadProgress:function(e){return z(Math.round(100*e.loaded/e.total))}});case 13:s=e.sent,i=s.data,console.log(i),L(A(A({},I),{},{video:i})),F(!1);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=Object(s.a)(o.a.mark((function e(a){var r,c,s,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.next=3,f.a.put("/api/course/lesson/".concat(K,"/").concat(I._id),I);case 3:r=e.sent,c=r.data,U("Upload Video"),E(!1),Object(b.b)("Lesson Updated"),n(c),c.ok&&(s=t.lessons,i=s.findIndex((function(e){return e._id===I._id})),s[i]=I,n(A(A({},t),{},{lessons:s})),Object(b.b)("Lesson Updated"));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)(l.a,{children:[Object(a.jsx)("h1",{className:"p-5 jumbotron text-center bg-primary",children:"Edit Course"}),Object(a.jsx)("div",{className:"pt-3 pb-3",children:Object(a.jsx)(u.a,{handleSubmit:Y,handleImageRemove:X,handleImage:function(e){var a=e.target.files[0];w(window.URL.createObjectURL(a)),N(a.name),n(A(A({},t),{},{loading:!0})),p.a.imageFileResizer(a,720,500,"JPEG",100,0,function(){var e=Object(s.a)(o.a.mark((function e(a){var r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.post("/api/course/upload-image",{image:a});case 3:r=e.sent,c=r.data,console.log("Image Uploaded",c),m(c),n(A(A({},t),{},{loading:!1})),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0),n(A(A({},t),{},{loading:!1})),Object(b.b)("Image upload failed. Try again");case 15:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}())},handleChange:function(e){n(A(A({},t),{},Object(r.a)({},e.target.name,e.target.value)))},values:t,setValues:n,preview:x,uploadButtonText:C,editPage:!0})}),Object(a.jsx)("hr",{}),Object(a.jsx)("div",{className:"row pb-5",children:Object(a.jsxs)("div",{className:"col lesson-list",children:[Object(a.jsxs)("h4",{children:[t&&t.lessons&&t.lessons.length," Lessons"]}),Object(a.jsx)(h.b,{itemLayout:"horizontal",dataSource:t&&t.lessons,renderItem:function(e,t){return Object(a.jsxs)(h.b.Item,{children:[Object(a.jsx)(h.b.Item.Meta,{onClick:function(){E(!0),L(e)},avatar:Object(a.jsx)(O.a,{children:t+1}),title:e.title}),Object(a.jsx)(y,{onClick:function(){return q(t)},className:"text-danger float-right"})]})}})]})}),Object(a.jsx)(v.a,{title:"Update Lesson",centered:!0,visible:_,onCancel:function(){return E(!1)},footer:null,children:Object(a.jsx)(M,{current:I,setCurrent:L,handleVideo:W,handleUpdateLesson:Q,uploadVideoButtonText:T,progress:R,uploading:B})})]})}}},[["1dNT",1,2,0,3,4,5,6,7,8,9,10,11,13,16,15,18,20]]]);